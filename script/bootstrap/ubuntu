#!/usr/bin/env bash
#
# Bootstrap dotfiles on a fresh ubuntu install

sudo apt-get install -y \
  ack-grep \
  build-essential \
  curl \
  dnsutils \
  finger \
  less \
  libssl-dev \
  screen \
  unzip \
  vim \
  wget \
  zsh

adduser --shell "$(which zsh)" --disabled-password --gecos "" shared

sudo mkdir /home/shared/.ssh && \
sudo touch /home/shared/.ssh/authorized_keys && \
sudo chown -R shared:shared /home/shared/.ssh
sudo /bin/bash -c \
  "cat $HOME/.ssh/authorized_keys >> /home/shared/.ssh/authorized_keys
"
mkdir ~/bin &&
export DOTSPATH="$HOME/.dotfiles" && \
cp ~/.ssh/* ~/.dotfiles/.ssh/ && \
cd "$DOTSPATH" && \
git submodule init && git submodule update --init --recursive && \
./bin/dots link --overwrite --with-backup &&
./bin/dots bin link

$(which zsh) --login
